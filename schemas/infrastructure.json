{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "The definition namespace for infrastructure components pertaining to a Nox solution.",
  "description": "Define components pertinent to solution infrastructure here. Examples include persistence, messaging, dependencies and endpoints.",
  "oneOf": [
    {
      "type": "object"
    },
    {
      "type": "null"
    }
  ],
  "properties": {
    "persistence": {    
      "anyOf": [
        { "$ref": "persistence.json" },
        {
          "additionalProperties": false, 
          "properties": {
            "$ref": {
              "type": "string",
              "format": "uri",
              "pattern": "^[^\\s]*$"
            }
          }
        }
      ]
    },
    "messaging": {    
      "title": "The definition namespace for messaging settings pertaining to a Nox solution.",
      "description": "Defines settings pertinent to solution messaging here. These include IntegrationEventServer provider (RabbitMQ, Azure ServiceBus, Amazon SQS etc) and additional server connection details.",
      "oneOf": [
        {
          "type": "object"
        },
        {
          "type": "null"
        }
      ],
      "required": [
        "integrationEventServer"
      ],
      "properties": {
        "integrationEventServer": {    
          "anyOf": [
            { "$ref": "messagingServer.json" },
            {
              "additionalProperties": false, 
              "properties": {
                "$ref": {
                  "type": "string",
                  "format": "uri",
                  "pattern": "^[^\\s]*$"
                }
              }
            }
          ]
        }
      },
      "additionalProperties": false
    },
    "endpoints": {    
      "title": "The definition namespace for default endpoints pertaining to a Nox solution.",
      "description": "Define default endpoints pertinent to a Nox solution here. These include endpoints for API and BFF servers.",
      "oneOf": [
        {
          "type": "object"
        },
        {
          "type": "null"
        }
      ],
      "properties": {
        "apiRoutePrefix": {    
          "title": "The api route prefix, defaults to api/v1 or to api/vMajor({Solution.Version}) if Version is set in the root of the Solution.",
          "description": "Defines the prefix for all Api routes end points.",
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ]
        },
        "apiServer": {    
          "anyOf": [
            { "$ref": "apiServer.json" },
            {
              "additionalProperties": false, 
              "properties": {
                "$ref": {
                  "type": "string",
                  "format": "uri",
                  "pattern": "^[^\\s]*$"
                }
              }
            }
          ]
        },
        "bffServer": {    
          "anyOf": [
            { "$ref": "bffServer.json" },
            {
              "additionalProperties": false, 
              "properties": {
                "$ref": {
                  "type": "string",
                  "format": "uri",
                  "pattern": "^[^\\s]*$"
                }
              }
            }
          ]
        }
      },
      "additionalProperties": false
    },
    "dependencies": {    
      "anyOf": [
        { "$ref": "dependencies.json" },
        {
          "additionalProperties": false, 
          "properties": {
            "$ref": {
              "type": "string",
              "format": "uri",
              "pattern": "^[^\\s]*$"
            }
          }
        }
      ]
    },
    "security": {    
      "anyOf": [
        { "$ref": "security.json" },
        {
          "additionalProperties": false, 
          "properties": {
            "$ref": {
              "type": "string",
              "format": "uri",
              "pattern": "^[^\\s]*$"
            }
          }
        }
      ]
    }
  },
  "additionalProperties": false
}
