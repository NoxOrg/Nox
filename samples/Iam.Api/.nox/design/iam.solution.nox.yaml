#
# SampleCurrency.solution.nox.yaml
# 
# yaml-language-server: $schema=../../../../schemas/solution.json
#
# PROD-yaml-language-server: $schema=https://noxorg.dev/schemas/solution.json
#

name: IamApi

description: Iam

domain:

  entities:

    - $ref: ./User/user.entity.nox.yaml
    
    - $ref: ./User/role.entity.nox.yaml
  
    - $ref: ./User/usercontactselection.entity.nox.yaml
        
    - $ref: ./Application/application.entity.nox.yaml  
  
    - name: EmailAddress
      description: Verified Email Address

      keys:
        - name: Email
          isRequired: true
          description: Email
          type: email

      attributes:
        - name: IsVerified
          description: Verified
          type: boolean
          isRequired: false
  
      persistence: 
        isAudited: false #owned entity => need to suport one to one relations

      # relationships:
    
      # - name: EmailForUser
      #   description: belongs to a User
      #   relationship: exactlyOne
      #   entity: UserIam

    - name: Phone
      description: Verified Phone

      keys:
        - name: PhoneNumber
          isRequired: true
          description: Phone
          type: phoneNumber

      attributes:
        - name: IsVerified
          description: Verified
          type: boolean
          isRequired: false
        - name: CountryCode
          description: Country code
          type: countryCode2
          isRequired: false
  
      persistence: 
        isAudited: false #owned entity

      # relationships:
    
      # - name: PhoneForUser
      #   description: belongs to a User
      #   relationship: exactlyOne
      #   entity: UserIam

infrastructure:
  
  persistence:

    databaseServer:
      name: IamService
      provider: sqlServer
      options: Trusted_Connection=no;connection timeout=120;TrustServerCertificate=True
      serverUri: localhost
      user: sa  
      password: Developer*123

application:
  dataTransferObjects:
    - name: TempDto
      description: Temp Dto added to help Generator Compile
      attributes:
        - name: Id
          description: Identity
          type: text
          textTypeOptions:
            casing: lower
            maxLength: 2
            minLength: 2
